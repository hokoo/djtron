<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>djTRON</title>
	<link rel="icon" type="image/svg+xml" href="/favicon.svg"/>
	<link rel="stylesheet" href="/styles.css"/>
</head>
<body>
<div class="layout">
	<aside class="sidebar" id="sidebar">
		<button id="sidebarToggle" class="secondary ghost sidebar-toggle" aria-label="Toggle panel">☰</button>
		<div class="sidebar-scroll">
			<header class="sidebar__header">
				<h1>djTRON</h1>
			</header>
			<label class="settings-toggle-row sidebar-settings-toggle" for="showVolumePresets">
				<span>Пресеты громкости</span>
				<input type="checkbox" id="showVolumePresets" class="cohost-role-switch settings-toggle-switch"/>
			</label>
			<label class="settings-toggle-row sidebar-settings-toggle" for="liveSeekEnabled">
				<span>Seek</span>
				<input type="checkbox" id="liveSeekEnabled" class="cohost-role-switch settings-toggle-switch"/>
			</label>
			<section class="panel sidebar-panel dap-settings" id="dapSettingsPanel" hidden>
				<label class="settings-toggle-row dap-settings__toggle-row" for="dapEnabled">
					<span>DAP</span>
					<input type="checkbox" id="dapEnabled" class="cohost-role-switch settings-toggle-switch"/>
				</label>
				<label class="dap-settings__field" for="dapPlaylistSelect">
					<span>Плей-лист DAP</span>
					<select id="dapPlaylistSelect"></select>
				</label>
				<label class="dap-settings__field" for="dapVolumePercent">
					<span>Громкость DAP (%)</span>
					<input type="number" id="dapVolumePercent" min="0" max="100" step="1" inputmode="numeric"/>
				</label>
			</section>
			<section class="panel sidebar-panel" id="overlaySettingsPanel">
				<div class="settings">
					<label>
						<span class="settings-label-row">
							<span>Перекрытие (с)</span>
							<input
								type="checkbox"
								id="overlayEnabled"
								class="cohost-role-switch settings-toggle-switch"
								aria-label="Включить перекрытие"
								checked
							/>
						</span>
						<input type="number" id="overlayTime" min="0" step="0.1"/>
					</label>
					<label>
						<span class="settings-label-row">
							<span>Затухание (с)</span>
							<input
								type="checkbox"
								id="stopFadeEnabled"
								class="cohost-role-switch settings-toggle-switch"
								aria-label="Включить затухание"
								checked
							/>
						</span>
						<input type="number" id="stopFadeTime" min="0" step="0.1"/>
					</label>
					<label>
						Функция изменения громкости
						<select id="overlayCurve">
							<option value="linear">Linear</option>
							<option value="ease-in">Ease-in</option>
							<option value="ease-out">Ease-out</option>
							<option value="ease-in-out">Ease-in-out</option>
						</select>
					</label>
				</div>
			</section>

			<div id="cohostPanel" class="cohost-panel" hidden>
				<div id="cohostUsers" class="cohost-users" aria-live="polite"></div>
			</div>

			<div class="sidebar-quick-actions">
				<button
					id="refreshPlaylists"
					class="secondary ghost"
					type="button"
					title="Обновить список треков и папок из /audio, включая авто-плей-листы"
					aria-label="Обновить список треков и папок из /audio, включая авто-плей-листы"
				>Обновить</button>
				<button id="resetPlaylists" class="secondary ghost" type="button">Сбросить</button>
				<button id="addPlaylist" class="secondary ghost" type="button">+ Плей-лист</button>
				<button id="touchFullscreenToggle" class="secondary ghost fullscreen-toggle" type="button" hidden aria-label="Полноэкранный режим">⛶</button>
			</div>

			<div id="dspSetupPanel" class="server-panel dsp-setup" hidden>
				<p class="dsp-setup__title">DSP переходы недоступны</p>
				<p class="dsp-setup__hint">Установите FFmpeg на ПК хоста:</p>
				<code id="dspInstallCommand" class="dsp-setup__command">winget install "FFmpeg (Essentials Build)"</code>
				<div class="dsp-setup__actions">
					<button id="dspCopyInstallCommand" class="secondary ghost" type="button">Скопировать</button>
					<button id="dspCheckInstall" class="secondary ghost" type="button">Проверить</button>
				</div>
				<p id="dspSetupStatus" class="dsp-setup__status" aria-live="polite"></p>
			</div>

			<div id="serverPanel" class="server-panel">
				<div class="server-actions">
					<button id="stopServer" class="secondary danger">Остановить сервер</button>
				</div>
			</div>

			<div id="clientSessionPanel" class="server-panel" hidden>
				<div class="server-actions">
					<button id="clientLogout" class="secondary ghost">Отключиться</button>
				</div>
			</div>

			<section class="panel sidebar-panel sidebar-repo">
				<p class="sidebar-repo__title">Репозиторий проекта
					<a class="sidebar-repo__link" href="https://github.com/hokoo/djtron" target="_blank"
					   rel="noopener noreferrer">на GitHub</a>
				</p>
				<p id="appVersion" class="sidebar-repo__version" aria-live="polite"></p>
				<label class="update-settings">
					<input type="checkbox" id="allowPrerelease" />
					<span>Устанавливать пре-релизные версии</span>
				</label>
				<div id="updateInfo" class="update-info" hidden>
					<p id="updateMessage" class="update-info__message" aria-live="polite"></p>
					<div class="update-info__actions">
						<button id="updateButton" class="secondary">Обновить</button>
						<a id="releaseLink" class="sidebar-repo__link" href="#" target="_blank" rel="noopener noreferrer">Релиз</a>
					</div>
					<p id="updateStatus" class="update-info__status" aria-live="polite"></p>
				</div>
			</section>
		</div>
	</aside>

        <main class="content">
                <div class="content-header">
                        <div class="now-playing-grid">
                                <div id="hostNowPlaying" class="now-playing now-playing--host">
                                        <p id="hostNowPlayingTitle" class="now-playing__title">Live: ничего не играет</p>
                                        <div id="hostNowPlayingControl" class="now-playing-control now-playing-control--host">
                                                <span id="hostNowPlayingProgress" class="now-playing-control__progress"></span>
                                                <span id="hostNowPlayingReel" class="now-playing-control__reel" aria-hidden="true"></span>
                                                <span id="hostNowPlayingControlLabel" class="now-playing-control__label">▶</span>
                                                <span id="hostNowPlayingTime" class="now-playing-control__time"></span>
                                        </div>
                                </div>
                                <div id="dapNowPlaying" class="now-playing now-playing--dap">
                                        <p id="dapNowPlayingTitle" class="now-playing__title">DAP: ничего не играет</p>
                                        <div id="dapNowPlayingControl" class="now-playing-control now-playing-control--dap">
                                                <span id="dapNowPlayingProgress" class="now-playing-control__progress"></span>
                                                <span id="dapNowPlayingReel" class="now-playing-control__reel" aria-hidden="true"></span>
                                                <span id="dapNowPlayingControlLabel" class="now-playing-control__label">▶</span>
                                                <span id="dapNowPlayingTime" class="now-playing-control__time"></span>
                                        </div>
                                </div>
                                <div id="localNowPlaying" class="now-playing now-playing--local">
                                        <p id="nowPlayingTitle" class="now-playing__title">Ничего не играет</p>
                                        <div class="now-playing-actions">
                                                <button id="nowPlayingControl" class="now-playing-control" type="button" disabled>
                                                        <span id="nowPlayingProgress" class="now-playing-control__progress"></span>
                                                        <span id="nowPlayingReel" class="now-playing-control__reel" aria-hidden="true"></span>
                                                        <span id="nowPlayingControlLabel" class="now-playing-control__label">▶</span>
                                                        <span id="nowPlayingTime" class="now-playing-control__time"></span>
                                                </button>
                                                <div id="localVolumePresets" class="volume-presets" hidden>
                                                        <button class="volume-presets__button" type="button" data-volume="0.1">10%</button>
                                                        <button class="volume-presets__button" type="button" data-volume="0.3">30%</button>
                                                        <button class="volume-presets__button" type="button" data-volume="0.5">50%</button>
                                                </div>
                                        </div>
                                </div>
                        </div>
                </div>
                <section class="zones-panel">
                        <div id="zones" class="zones"></div>
                </section>
        </main>
</div>

<div id="authOverlay" class="auth-overlay" hidden>
	<form id="authForm" class="auth-card" autocomplete="off">
		<h2 class="auth-card__title">Вход в djTRON</h2>
		<label>
			Логин
			<input type="text" id="authUsername" name="username" autocomplete="username" required/>
		</label>
		<label>
			Пароль
			<input type="password" id="authPassword" name="password" autocomplete="current-password" required/>
		</label>
		<button type="submit" id="authSubmit" class="secondary">Войти</button>
		<p id="authError" class="auth-card__error" aria-live="polite"></p>
	</form>
</div>

<script src="/script.js" type="module"></script>
</body>
</html>
